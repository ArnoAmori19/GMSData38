SET QUOTED_IDENTIFIER ON
GO
SET ANSI_NULLS ON
GO
CREATE PROCEDURE [dbo].[b_SavePP](@ANewPP bit, @APriceCC numeric(21, 9),@ACostAC numeric(21, 9), @ACostCC numeric(21, 9), @APPWeight numeric(21, 9),  @APPDesc varchar(200), @AProdID int, @APPID int, @APriority int, @ACompID int, @AProdDate smalldatetime, @AArticle varchar(200),  @APPDelay smallint, @AProdPPDate smalldatetime, @AIsCommission bit,  @ACstProdCode varchar(200), @ACstDocCode varchar(200))/* Создает новую или изменяет существующую партию (Бухгалтерия) */AS  IF @ANewPP = 1    BEGIN      INSERT INTO b_PInP (ProdID, PPID, PriceCC_In, CostAC, CostCC, PriceMC, Priority, CompID, ProdDate, Article, PPWeight, PPDelay, PPDesc, ProdPPDate, IsCommission, CstProdCode, CstDocCode) VALUES (                  @AProdID , @APPID,  @APriceCC, @ACostAC, @ACostCC, 0, @APriority, @ACompID, @AProdDate, @AArticle, @APPWeight, @APPDelay, @APPDesc, @AProdPPDate, @AIsCommission, @ACstProdCode, @ACstDocCode)    END  ELSE    BEGIN      UPDATE b_PInP      SET        CostAC = @ACostAC,        CompID = @ACompID,        ProdDate = @AProdDate,        Article = @AArticle,        PriceCC_In = @APriceCC,        CostCC = @ACostCC,        PPWeight = @APPWeight,        PPDelay = @APPDelay,        PPDesc = @APPDesc,        Priority = @APriority,        ProdPPDate = @AProdPPDate,        IsCommission = @AIsCommission,        CstProdCode = @ACstProdCode,        CstDocCode = @ACstDocCode      WHERE ProdID = @AProdID AND PPID = @APPID    END
GO
